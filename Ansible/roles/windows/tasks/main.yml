---
# Windows hardening

- name: Gather Windows facts
  tags: always
  setup:

# --- Windows Firewall ---
- name: Configure Windows Firewall
  tags: [hardening, firewall]
  include_tasks: firewall.yml

# --- Disable Unnecessary Services ---
- name: Disable unnecessary Windows services
  tags: [hardening, services]
  include_tasks: disable_services.yml

# --- SMB Hardening ---
- name: Harden SMB
  tags: [hardening, smb]
  include_tasks: smb_hardening.yml

# --- RDP Hardening ---
- name: Harden RDP
  tags: [hardening, rdp]
  include_tasks: rdp_hardening.yml

# --- Windows Audit Policy ---
- name: Configure audit logging
  tags: [hardening, audit]
  include_tasks: audit_policy.yml

# --- Disable Dangerous Features ---
- name: Disable dangerous features
  tags: [hardening, features]
  include_tasks: disable_features.yml
